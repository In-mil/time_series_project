# Time Series Prediction Project

[![GitHub Actions](https://img.shields.io/github/actions/workflow/status/In-mil/time_series_project/dvc_pipeline.yml?branch=main&logo=github)](https://github.com/In-mil/time_series_project/actions)
[![DVC](https://img.shields.io/badge/DVC-enabled-blueviolet?logo=dvc)](https://dvc.org/)
[![MLflow](https://img.shields.io/badge/MLflow-tracking-orange?logo=mlflow)](https://mlflow.org/)
[![Docker](https://img.shields.io/badge/Docker-ready-2496ED?logo=docker)](https://www.docker.com/)
[![Python](https://img.shields.io/badge/Python-3.11+-blue?logo=python)](https://www.python.org/)
[![TensorFlow](https://img.shields.io/badge/TensorFlow-2.15+-orange?logo=tensorflow)](https://www.tensorflow.org/)

---

## Overview

This project implements and compares several **deep learning architectures** for **financial time series forecasting**, using cryptocurrency and macroeconomic data.  
The models are trained and versioned with **DVC**, evaluated via **MLflow**, and deployed through **GitHub Actions**.

---

## Model Architectures

| Model | Type | Key Features | Typical Use Case |
|--------|------|---------------|------------------|
| **ANN (Artificial Neural Network)** | Feedforward dense layers | Simple and fast, no temporal context | Baseline for non-sequential dependencies |
| **GRU (Gated Recurrent Unit)** | Recurrent (2 gates) | Efficient and lightweight | Short-term sequence modeling |
| **LSTM (Long Short-Term Memory)** | Recurrent (3 gates) | Captures long-term dependencies | Complex time dependencies |
| **Transformer** | Attention-based | Learns relationships without recurrence | Scalable sequence processing |
| **Ensemble** | Averaged predictions | Combines model strengths | More stable, generalizable output |

---

##  Tracking & Storage

| Component | Location / Tool | Contents | Managed by |
|------------|------------------|-----------|-------------|
| **Code & Configs** | GitHub Repo (`main` branch) | Python scripts, notebooks, YAMLs | Git |
| **Datasets** | Google Cloud Storage (GCS) â†’ `gs://time-series-dvc-storage/.dvc/cache` | Versioned raw & processed CSV files | DVC |
| **Models** | DVC Remote (GCS) | Trained `.keras` model weights | DVC |
| **Evaluation Reports** | `/reports/metrics.json` | Final metrics (MAE, MSE) | Git |
| **Experiments** | MLflow (`mlflow.db`) | Logged metrics & artifacts | MLflow |
| **CI/CD** | `.github/workflows/dvc_pipeline.yml` | Automated training & evaluation | GitHub Actions |
| **Docker Image** | Google Container Registry (GCR) | Production-ready API container | Docker + GH Actions |

---

## Docker Deployment

The trained models can be deployed as a **FastAPI prediction service** via Docker.

### Local Build & Run

```bash
# Pull models from DVC and build image
./build_docker.sh

# Run container
docker run -p 8000:8000 time-series-api:latest

# Test API
curl http://localhost:8000
```

### Automatic Build (GitHub Actions)

After successful model training, `.github/workflows/docker-build.yml` automatically:
1. Pulls trained models from DVC
2. Builds Docker image
3. Pushes to Google Container Registry

**Image location**: `europe-west3-docker.pkg.dev/{project}/time-series/time-series-api:latest`

### Cloud Run Deployment (Optional)

Uncomment deployment steps in `docker-build.yml` for automatic Cloud Run deployment.

ðŸ“– **Detailed guide**: [DOCKER.md](DOCKER.md)

---

## Project Structure

```
.
â”œâ”€â”€ .github/workflows/
â”‚   â”œâ”€â”€ dvc_pipeline.yml      # Main: Training pipeline
â”‚   â”œâ”€â”€ dvc-ci.yml            # Alternative CI config
â”‚   â””â”€â”€ docker-build.yml      # Docker build & push
â”œâ”€â”€ models/                    # Model training scripts
â”‚   â”œâ”€â”€ ann_model.py
â”‚   â”œâ”€â”€ gru_model.py
â”‚   â”œâ”€â”€ lstm_model.py
â”‚   â”œâ”€â”€ transformer_model.py
â”‚   â””â”€â”€ ensemble_model.py
â”œâ”€â”€ service/
â”‚   â””â”€â”€ app.py                # FastAPI prediction API
â”œâ”€â”€ evaluation/
â”‚   â””â”€â”€ evaluate_models.py    # Model evaluation
â”œâ”€â”€ data/final_data/
â”‚   â””â”€â”€ *.csv.dvc             # DVC-tracked datasets
â”œâ”€â”€ Dockerfile                # Production container
â”œâ”€â”€ build_docker.sh           # Local Docker build
â”œâ”€â”€ dvc.yaml                  # DVC pipeline
â””â”€â”€ requirements.txt          # Dependencies
```

---
## pending:
